---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
editor_options: 
  chunk_output_type: console
---


## Loading and preprocessing the data
Unzip data to obtain a csv file.

```{r}
library(ggplot2)
library(lubridate)
unzip("activity.zip",exdir = "data")
```
Load Data
```{r}
activity <- read.csv("data/activity.csv",stringsAsFactors=FALSE)
```
Change type of date column to Date
```{r}
activity$date<-ymd(activity$date)
```

## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day

```{r}
stepsPerDay <- aggregate(activity$steps, list(activity$date), FUN=sum)
colnames(stepsPerDay) <- c("Date", "Steps")
head(stepsPerDay)
```

2. Histogram of the total number of steps taken each day
```{r}
# draw the histogram
hPlot <- ggplot(stepsPerDay, aes(Steps))
hPlot+
  geom_histogram(fill="blue",col="green",binwidth=2000)+
  ggtitle("Steps per day")+
  xlab("Steps")+
  ylab("Frequency")+
  scale_x_continuous(breaks=seq(0,24000,4000))+
  scale_y_continuous(breaks=seq(0,14,2))
```

3. Mean and median number of steps taken each day

Mean
```{r}
mean(stepsPerDay$Steps, na.rm=TRUE)
```
Median

```{r}
median(stepsPerDay$Steps, na.rm=TRUE)
```

## What is the average daily activity pattern?
1.Time series plot of the average number of steps taken
```{r}
# create steps/time
stepsPerInterval <- aggregate(steps~interval,data=activity,FUN=mean,na.action=na.omit)
# line plot
lPlot <- ggplot(stepsPerInterval, aes(interval, steps))
lPlot+geom_line(col="blue")+
  ggtitle("Average steps per interval")+
  xlab("interval")+
  ylab("Steps")
```

1. The 5-minute interval that, on average, contains the maximum number of steps
```{r}
stepsPerInterval[which.max(stepsPerInterval$steps),]$interval
```
## Imputing missing values
1. find percentage of NA
```{r}
mean(is.na(activity$steps))*100

```
2. strategy for imputing missing data
Use average  5-minute interval to replace NA
```{r}
activity$CompleteSteps <- ifelse(is.na(activity$steps), round(stepsPerInterval$steps[match(activity$interval, stepsPerInterval$interval)],0), activity$steps)
activityNoNA <- data.frame(steps=activity$CompleteSteps, interval=activity$interval, date=activity$date)
head(activityNoNA)
```

3. Histogram of the total number of steps taken each day
Calculate the total number of steps taken per day

```{r}
stepsPerDayNoNA <- aggregate(activityNoNA$steps, list(activityNoNA$date), FUN=sum)
colnames(stepsPerDayNoNA) <- c("Date", "Steps")
head(stepsPerDayNoNA)
```

draw the histogram
```{r}

noNAPlot <- ggplot(stepsPerDayNoNA, aes(Steps))
noNAPlot+
  geom_histogram(fill="blue",col="green",binwidth=2000)+
  ggtitle("Steps per day")+
  xlab("Steps")+
  ylab("Frequency")
```


## Are there differences in activity patterns between weekdays and weekends?
